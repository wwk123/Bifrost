# ğŸ® æ¸¸æˆåŒ–ç»„ä»¶é€ŸæŸ¥è¡¨

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
npm install canvas-confetti
npm install --save-dev @types/canvas-confetti
```

### å¯¼å…¥ç»„ä»¶
```tsx
import {
  CelebrationAnimation,
  useCelebration,
  DailySpinWheel,
  SocialFeed,
  useSocialFeed
} from '@/components';
```

---

## 1ï¸âƒ£ åº†ç¥åŠ¨ç”»

### åŸºç¡€ä½¿ç”¨
```tsx
function MyComponent() {
  const { celebration, celebrate, handleComplete } = useCelebration();

  return (
    <>
      <button onClick={() => celebrate('stake_success', 'æˆåŠŸè´¨æŠ¼ 100 DOT')}>
        è´¨æŠ¼
      </button>

      <CelebrationAnimation
        type={celebration.type}
        message={celebration.message}
        show={celebration.show}
        onComplete={handleComplete}
      />
    </>
  );
}
```

### å¯ç”¨ç±»å‹
```tsx
celebrate('stake_success')      // ğŸ’¸ é‡‘å¸é›¨
celebrate('first_rank')         // ğŸ‘‘ äº”å½©çº¸å±‘
celebrate('achievement_unlock') // ğŸ† è„‰å†²å…‰æ•ˆ
celebrate('overtake_friend')    // âš¡ é—ªç”µ
celebrate('milestone_reached')  // ğŸ‰ çƒŸèŠ±
```

---

## 2ï¸âƒ£ æ¯æ—¥è½¬ç›˜

### åŸºç¡€ä½¿ç”¨
```tsx
function RewardsPage() {
  const [canSpin, setCanSpin] = useState(true);
  const [timeLeft, setTimeLeft] = useState(0);

  const handleReward = (reward) => {
    console.log('è·å¾—:', reward.item);
    setCanSpin(false);
    setTimeLeft(86400); // 24å°æ—¶
  };

  return (
    <DailySpinWheel
      onRewardClaimed={handleReward}
      canSpin={canSpin}
      remainingTime={timeLeft}
    />
  );
}
```

### å¥–åŠ±é…ç½®
åœ¨ `DailySpinWheel.tsx` ä¸­ä¿®æ”¹ `REWARDS` æ•°ç»„:
```tsx
const REWARDS: Reward[] = [
  {
    id: '1',
    item: '10 BNC',
    icon: 'ğŸª™',
    probability: 40,
    color: '#94a3b8',
    rarity: 'common'
  },
  // ... æ›´å¤šå¥–åŠ±
];
```

---

## 3ï¸âƒ£ ç¤¾äº¤åŠ¨æ€æµ

### åŸºç¡€ä½¿ç”¨
```tsx
function Layout({ children }) {
  const { events, addEvent } = useSocialFeed();

  // æ·»åŠ äº‹ä»¶
  const notifyOvertake = (userName) => {
    addEvent({
      type: 'friend_overtook_you',
      message: `${userName} åˆšåˆšè¶…è¶Šäº†ä½ !`,
      cta: 'ç«‹å³åå‡»',
      urgency: 'high',
      userName,
      userAvatar: `https://api.dicebear.com/7.x/avataaars/svg?seed=${userName}`
    });
  };

  return (
    <>
      {children}
      <SocialFeed
        events={events}
        maxVisible={3}
        position="bottom-right"
        onEventClick={(e) => console.log(e)}
      />
    </>
  );
}
```

### äº‹ä»¶ç±»å‹
```tsx
// å¥½å‹è¶…è¶Š (é«˜ä¼˜å…ˆçº§)
addEvent({
  type: 'friend_overtook_you',
  urgency: 'high'
});

// å¥½å‹è§£é”æˆå°± (ä¸­)
addEvent({
  type: 'friend_unlocked',
  urgency: 'medium'
});

// å›¢é˜Ÿè·èƒœ (é«˜)
addEvent({
  type: 'team_won',
  urgency: 'high'
});

// æ®µä½æ™‹å‡ (ä¸­)
addEvent({
  type: 'new_rank_achieved',
  urgency: 'medium'
});

// é‡Œç¨‹ç¢‘ (é«˜)
addEvent({
  type: 'milestone_reached',
  urgency: 'high'
});

// æŒ‘æˆ˜å®Œæˆ (ä¸­)
addEvent({
  type: 'challenge_completed',
  urgency: 'medium'
});
```

### ä½ç½®é€‰é¡¹
```tsx
<SocialFeed position="bottom-right" /> // å³ä¸‹è§’
<SocialFeed position="top-right" />    // å³ä¸Šè§’
<SocialFeed position="bottom-left" />  // å·¦ä¸‹è§’
<SocialFeed position="top-left" />     // å·¦ä¸Šè§’
```

---

## ğŸ¯ å®æˆ˜ç¤ºä¾‹

### è´¨æŠ¼æˆåŠŸæµç¨‹
```tsx
async function handleStake(amount: number) {
  try {
    // 1. æ‰§è¡Œè´¨æŠ¼
    await stakeTokens(amount);

    // 2. è§¦å‘åº†ç¥åŠ¨ç”»
    celebrate('stake_success', `æˆåŠŸè´¨æŠ¼ ${amount} DOT`);

    // 3. æ·»åŠ ç¤¾äº¤åŠ¨æ€
    addEvent({
      type: 'milestone_reached',
      message: `ä½ è´¨æŠ¼äº† ${amount} DOT!`,
      cta: 'æŸ¥çœ‹æ”¶ç›Š',
      urgency: 'medium'
    });

    // 4. æ£€æŸ¥æ˜¯å¦è§£é”æˆå°±
    const newAchievements = checkAchievements(totalStaked);
    if (newAchievements.length > 0) {
      celebrate('achievement_unlock', `è§£é”ã€Œ${newAchievements[0].name}ã€`);
    }

  } catch (error) {
    toast.error('è´¨æŠ¼å¤±è´¥');
  }
}
```

### æ’åå˜åŒ–ç›‘å¬
```tsx
useEffect(() => {
  const unsubscribe = subscribeToRankChanges((change) => {
    if (change.type === 'overtaken') {
      // è¢«è¶…è¶Š
      addEvent({
        type: 'friend_overtook_you',
        message: `${change.userName} è¶…è¶Šäº†ä½ !`,
        cta: 'ç«‹å³åå‡»',
        urgency: 'high',
        userName: change.userName,
        details: { rank: change.newRank }
      });
    } else if (change.type === 'milestone') {
      // è¾¾åˆ°é‡Œç¨‹ç¢‘
      celebrate('milestone_reached', `æ’åè¿›å…¥å‰ ${change.milestone}!`);
    }
  });

  return () => unsubscribe();
}, []);
```

---

## ğŸ¨ æ ·å¼è‡ªå®šä¹‰

### ä¿®æ”¹åŠ¨ç”»æ—¶é•¿
```tsx
// CelebrationAnimation.tsx ä¸­
animate={{ opacity: 1, scale: 1, y: 0 }}
transition={{
  duration: 0.6,  // æ”¹ä¸º 1.0 ç§’
  bounce: 0.4     // æ”¹ä¸º 0.2 å‡å°‘å¼¹æ€§
}}
```

### ä¿®æ”¹è½¬ç›˜å°ºå¯¸
```tsx
// DailySpinWheel.tsx ä¸­
<div className="relative w-[400px] h-[400px]"> // æ”¹ä¸º w-[500px] h-[500px]
```

### ä¿®æ”¹åŠ¨æ€æµæ ·å¼
```tsx
// SocialFeed.tsx ä¸­
className={`
  bg-slate-800/95 backdrop-blur-lg  // èƒŒæ™¯é€æ˜åº¦
  rounded-xl border-2               // åœ†è§’å’Œè¾¹æ¡†
  shadow-xl                         // é˜´å½±å¤§å°
`}
```

---

## ğŸ”§ è¿›é˜¶æŠ€å·§

### 1. é“¾å¼è§¦å‘
```tsx
celebrate('stake_success');

setTimeout(() => {
  addEvent({ ... });
}, 3000); // åŠ¨ç”»ç»“æŸåè§¦å‘
```

### 2. æ¡ä»¶è§¦å‘
```tsx
if (totalStaked > 1000) {
  celebrate('milestone_reached', 'è´¨æŠ¼è¶…è¿‡ 1000 DOT!');
}

if (rank === 1) {
  celebrate('first_rank', 'ç™»é¡¶æ’è¡Œæ¦œ!');
}
```

### 3. æ‰¹é‡äº‹ä»¶
```tsx
const batchNotify = (events) => {
  events.forEach((event, index) => {
    setTimeout(() => {
      addEvent(event);
    }, index * 2000); // æ¯2ç§’ä¸€ä¸ª
  });
};
```

---

## ğŸ“± å“åº”å¼é€‚é…

### ç§»åŠ¨ç«¯ä¼˜åŒ–
```tsx
// æ£€æµ‹è®¾å¤‡ç±»å‹
const isMobile = window.innerWidth < 768;

// è°ƒæ•´åŠ¨ç”»å¼ºåº¦
<CelebrationAnimation
  show={show}
  type={type}
  // ç§»åŠ¨ç«¯å‡å°‘ç²’å­æ•°
  particleCount={isMobile ? 50 : 100}
/>

// è°ƒæ•´è½¬ç›˜å¤§å°
<div className={`relative ${isMobile ? 'w-[300px] h-[300px]' : 'w-[400px] h-[400px]'}`}>
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. æ‡’åŠ è½½åŠ¨ç”»
```tsx
const CelebrationAnimation = dynamic(
  () => import('@/components/animations/CelebrationAnimation'),
  { ssr: false }
);
```

### 2. äº‹ä»¶èŠ‚æµ
```tsx
import { throttle } from 'lodash';

const throttledAddEvent = throttle(addEvent, 2000);
```

### 3. æ¸…ç†å®šæ—¶å™¨
```tsx
useEffect(() => {
  const timer = setTimeout(() => {
    celebrate('...');
  }, 1000);

  return () => clearTimeout(timer);
}, []);
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q: åŠ¨ç”»ä¸æ˜¾ç¤º?
A: æ£€æŸ¥ `show` prop æ˜¯å¦ä¸º `true`

### Q: è½¬ç›˜æ— æ³•æ—‹è½¬?
A: æ£€æŸ¥ `canSpin` å’Œ `remainingTime`

### Q: åŠ¨æ€æµè¢«é®æŒ¡?
A: è°ƒæ•´ `z-index` æˆ–æ”¹å˜ `position`

### Q: äº”å½©çº¸å±‘å¡é¡¿?
A: å‡å°‘ `particleCount` æ•°é‡

---

## ğŸ‰ å®Œæˆ!

ç°åœ¨ä½ å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨è¿™äº›ç‚«é…·çš„æ¸¸æˆåŒ–åŠŸèƒ½äº†!

è®¿é—®æ¼”ç¤º: http://localhost:3001/demo/gamification
